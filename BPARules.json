[
  {
    "ID": "AVOID_DUPLICATE_MEASURES",
    "Name": "[DAX Expressions] No two measures should have the same definition",
    "Category": "DAX Expressions",
    "Description": "No two measures should have the same definition.",
    "Severity": 2,
    "Scope": "Measure",
    "Expression": "Model.AllMeasures.Any(Expression.Replace(\" \",\"\").Replace(\"\\n\",\"\").Replace(\"\\r\",\"\").Replace(\"\\t\",\"\") = outerIt.Expression.Replace(\" \",\"\").Replace(\"\\n\",\"\").Replace(\"\\r\",\"\").Replace(\"\\t\",\"\") and it <> outerIt)",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "USE_THE_DIVIDE_FUNCTION_FOR_DIVISION",
    "Name": "[DAX Expressions] Use the DIVIDE function for division",
    "Category": "DAX Expressions",
    "Description": "The DIVIDE function is more efficient and provides better error handling than the division operator \"/\".",
    "Severity": 2,
    "Scope": "Measure,CalculatedColumn,CalculatedTable,CalculationItem",
    "Expression": "RegEx.IsMatch(Expression,\"\\]\\s*\\/(?!\\/)(?!\\*)\") or RegEx.IsMatch(Expression,\"\\)\\s*\\/(?!\\/)(?!\\*)\")",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "INACTIVE_RELATIONSHIPS_THAT_ARE_NEVER_ACTIVATED",
    "Name": "[DAX Expressions] Inactive relationships that are never activated",
    "Category": "DAX Expressions",
    "Description": "An inactive relationship is only useful if it is activated in a measure using the USERELATIONSHIP function. Otherwise, it is redundant.",
    "Severity": 2,
    "Scope": "Relationship",
    "Expression": "IsActive == false and not ( Model.AllMeasures.Any(RegEx.IsMatch(Expression, \"(?i)USERELATIONSHIP\\s*\\(\\s*\\'*\" + current.FromTable.Name + \"\\'*\\[\" + current.FromColumn.Name + \"\\]\\s*,\\s*\\'*\" + current.ToTable.Name + \"\\'*\\[\" + current.ToColumn.Name + \"\\]\")) or Model.AllCalculationItems.Any(RegEx.IsMatch(Expression, \"(?i)USERELATIONSHIP\\s*\\(\\s*\\'*\" + current.FromTable.Name + \"\\'*\\[\" + current.FromColumn.Name + \"\\]\\s*,\\s*\\'*\" + current.ToTable.Name + \"\\'*\\[\" + current.ToColumn.Name + \"\\]\")) )",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "RELATIONSHIP_COLUMNS_SAME_DATA_TYPE",
    "Name": "[Error Prevention] Relationship columns should be of the same data type",
    "Category": "Error Prevention",
    "Description": "Relationship columns should be of the same data type.",
    "Severity": 3,
    "Scope": "Relationship",
    "Expression": "FromColumn.DataType != ToColumn.DataType",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "SET_ISAVAILABLEINMDX_TO_TRUE_ON_NECESSARY_COLUMNS",
    "Name": "[Error Prevention] Set IsAvailableInMdx to true on necessary columns",
    "Category": "Error Prevention",
    "Description": "Columns used in hierarchies or as sort-by columns, should have IsAvailableInMdx set to true.",
    "Severity": 3,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "IsAvailableInMDX == false and (UsedInSortBy.Any() or UsedInHierarchies.Any() or SortByColumn != null)",
    "FixExpression": "IsAvailableInMDX = true",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "NUMERIC_COLUMN_SUMMARIZE_BY",
    "Name": "[Formatting] Do not summarize numeric columns",
    "Category": "Formatting",
    "Description": "It is good practice to set SummarizeBy to None on numeric columns that you do not want to aggregate.",
    "Severity": 3,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "(DataType = \"Int64\" or DataType = \"Double\" or DataType = \"Decimal\") and SummarizeBy <> \"None\" and not (IsHidden or Table.IsHidden) and IsKey == false",
    "FixExpression": "SummarizeBy = AggregateFunction.None",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "RELATIONSHIP_COLUMNS_SHOULD_BE_OF_INTEGER_DATA_TYPE",
    "Name": "[Formatting] Relationship columns should be of integer data type",
    "Category": "Formatting",
    "Description": "Relationship columns should be of integer data type.",
    "Severity": 1,
    "Scope": "Relationship",
    "Expression": "FromColumn.DataType != \"Int64\" or ToColumn.DataType != \"Int64\"",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "HIDE_FOREIGN_KEYS",
    "Name": "[Formatting] Hide foreign keys",
    "Category": "Formatting",
    "Description": "Foreign keys should generally be hidden.",
    "Severity": 2,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "UsedInRelationships.Any(FromColumn.Name == current.Name and FromCardinality == \"Many\") and IsHidden == false",
    "FixExpression": "IsHidden = true",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "HIDE_FACT_TABLE_COLUMNS",
    "Name": "[Formatting] Hide fact table columns",
    "Category": "Formatting",
    "Description": "Columns in fact tables should generally be hidden. (Uses table-name heuristic: Fact*/f_*/_*Fact)",
    "Severity": 2,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "IsHidden == false and IsKey == false and IsCalculated == false and IsNameInferred == false and (not UsedInRelationships.Any()) and (not UsedInSortBy.Any()) and (not UsedInHierarchies.Any()) and ( Table.Name.StartsWith(\"Fact\") or Table.Name.StartsWith(\"f_\") or Table.Name.EndsWith(\"_Fact\") )",
    "FixExpression": "IsHidden = true",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "UNNECESSARY_COLUMNS",
    "Name": "[Maintenance] Remove unnecessary columns",
    "Category": "Maintenance",
    "Description": "Remove columns that are not referenced by any measures, calculated columns, calculated tables, roles, perspectives, sort-by columns, hierarchies, relationships, or partitions.",
    "Severity": 2,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "ReferencedBy.Count = 0 and (not UsedInRelationships.Any()) and (not UsedInSortBy.Any()) and (not UsedInHierarchies.Any()) and ReferencedInRoles == false and ReferencedInPerspectives == false and ReferencedInPartitions == false and IsKey == false and IsHidden == false",
    "FixExpression": "Delete()",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "FIX_REFERENTIAL_INTEGRITY_VIOLATIONS",
    "Name": "[Maintenance] Fix referential integrity violations",
    "Category": "Maintenance",
    "Description": "Referential integrity violations may lead to unexpected query results.",
    "Severity": 2,
    "Scope": "Relationship",
    "Expression": "Violations.Count() > 0",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "ENSURE_TABLES_HAVE_RELATIONSHIPS",
    "Name": "[Maintenance] Ensure tables have relationships",
    "Category": "Maintenance",
    "Description": "Ensure tables have at least one relationship. Tables without relationships will not filter other tables.",
    "Severity": 1,
    "Scope": "Table, CalculatedTable",
    "Expression": "UsedInRelationships.Count() == 0 and IsHidden == false and IsPrivate == false",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "AVOID_FLOATING_POINT_DATA_TYPES",
    "Name": "[Performance] Do not use floating point data types",
    "Category": "Performance",
    "Description": "Floating point data types (Double) are not recommended due to potential rounding issues.",
    "Severity": 2,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "DataType = \"Double\"",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "AVOID_BI-DIRECTIONAL_RELATIONSHIPS_AGAINST_HIGH-CARDINALITY_COLUMNS",
    "Name": "[Performance] Avoid bi-directional relationships against high-cardinality columns",
    "Category": "Performance",
    "Description": "Bi-directional relationships can lead to expensive queries. (Cardinality check requires VertiPaq annotations; omitted here.)",
    "Severity": 2,
    "Scope": "Relationship",
    "Expression": "CrossFilteringBehavior == \"BothDirections\" or CrossFilteringBehavior == \"Automatic\"",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "REDUCE_USAGE_OF_LONG-LENGTH_COLUMNS_WITH_HIGH_CARDINALITY",
    "Name": "[Performance] Reduce usage of long-length columns with high cardinality",
    "Category": "Performance",
    "Description": "Long-length string columns can consume a lot of memory. (Cardinality check omitted.)",
    "Severity": 2,
    "Scope": "DataColumn, CalculatedColumn, CalculatedTableColumn",
    "Expression": "DataType = \"String\" and MaxLength > 50 and not (IsHidden or Table.IsHidden)",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "SNOWFLAKE_SCHEMA_ARCHITECTURE",
    "Name": "[Performance] Consider a star-schema instead of a snowflake architecture",
    "Category": "Performance",
    "Description": "Flags if a visible dimension-like table has more than 1 relationship (heuristic: Dim*/d_*).",
    "Severity": 2,
    "Scope": "Model",
    "Expression": "Model.Tables.Any( (not IsHidden) and (Name.StartsWith(\"Dim\") or Name.StartsWith(\"d_\")) and (Model.Relationships.Where(FromTable.Name == current.Name or ToTable.Name == current.Name).Count() > 1) )",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "REMOVE_AUTO-DATE_TABLE",
    "Name": "[Performance] Remove auto-date table",
    "Category": "Performance",
    "Description": "Auto-date tables can increase model size and reduce performance.",
    "Severity": 2,
    "Scope": "Model",
    "Expression": "Model.Tables.Any(IsDateTable and IsHidden and Name.StartsWith(\"LocalDateTable_\"))",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "MANY-TO-MANY_RELATIONSHIPS_SHOULD_BE_SINGLE-DIRECTION",
    "Name": "[Performance] Many-to-many relationships should be single-direction",
    "Category": "Performance",
    "Description": "Many-to-many relationships should generally be single-direction.",
    "Severity": 2,
    "Scope": "Relationship",
    "Expression": "FromCardinality == \"Many\" and ToCardinality == \"Many\" and (CrossFilteringBehavior == \"BothDirections\" or CrossFilteringBehavior == \"Automatic\")",
    "FixExpression": "CrossFilteringBehavior = \"OneDirection\"",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "REDUCE_USAGE_OF_CALCULATED_TABLES",
    "Name": "[Performance] Reduce usage of calculated tables",
    "Category": "Performance",
    "Description": "Calculated tables increase model size and may slow down refresh.",
    "Severity": 2,
    "Scope": "CalculatedTable",
    "Expression": "1=1",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "REMOVE_REDUNDANT_COLUMNS_IN_RELATED_TABLES",
    "Name": "[Performance] Remove redundant columns in related tables",
    "Category": "Performance",
    "Description": "Tables with relationships that still contain visible unused columns.",
    "Severity": 2,
    "Scope": "Table, CalculatedTable",
    "Expression": "UsedInRelationships.Count() > 0 and Columns.Any( (not IsHidden) and IsKey == false and (not UsedInRelationships.Any()) and (not UsedInSortBy.Any()) and (not UsedInHierarchies.Any()) and ReferencedBy.Count = 0 )",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  },
  {
    "ID": "REDUCE_NUMBER_OF_CALCULATED_COLUMNS",
    "Name": "[Performance] Reduce number of calculated columns",
    "Category": "Performance",
    "Description": "Calculated columns increase model size and may slow down refresh.",
    "Severity": 2,
    "Scope": "CalculatedColumn",
    "Expression": "IsHidden == false",
    "FixExpression": "",
    "CompatibilityLevel": 1200
  }
]
